<!DOCTYPE html>
<meta charset="utf-8">
<head>
  <!-- Import js here -->
  <script src="http://d3js.org/d3.v3.min.js"></script>
  <script src="http://d3js.org/topojson.v1.min.js"></script>

  <!-- Style here -->
  <link rel="stylesheet" href="index.css">
  <style>

  .county{
      fill: #AAFFFF;
  }

  .county-boundary {
    fill: none;
    stroke: #fff;
    stroke-linejoin: round;
  }

  .q0-9 { fill:rgb(247,251,255); }
  .q1-9 { fill:rgb(222,235,247); }
  .q2-9 { fill:rgb(198,219,239); }
  .q3-9 { fill:rgb(158,202,225); }
  .q4-9 { fill:rgb(107,174,214); }
  .q5-9 { fill:rgb(66,146,198); }
  .q6-9 { fill:rgb(33,113,181); }
  .q7-9 { fill:rgb(8,81,156); }
  .q8-9 { fill:rgb(8,48,107); }

  </style>
</head>

<!-- Main code/website goes here -->
<body>
  <!-- Make sure to seperate necessary code and imports for easier readability -->
  <!-- Seperating by div's to clean up code further -->
  <div id='header'>
    <div align='center' id='title'>
      <h1 class='Arial'> 2014 Reported Escherichia coli O157 </h1>
    </div>
  </div>

  <div id='filterPanel'>

  </div>

  <div id='choropleth'>
    <script>

      var width = 960,
          height = 500;

      var projection = d3.geo.albersUsa();

      var path = d3.geo.path()
          .projection(projection);

      var zoom = d3.behavior.zoom()
          .translate([0,0])
          .scale(1)
          .scaleExtent([1,8])
          .on("zoom", zoomed)

      var svg = d3.select("#choropleth").append("svg")
          .attr("width", width)
          .attr("height", height)
          .call(zoom);

      var vector = svg.append("g");

      d3.csv("EC_data2014_v2.csv")
          .row(function(d) { return {key: d.key, value: +d.value}; })
          .get(function(error, rows) { console.log(rows); });

      d3.json("us_counties_v2.json", function(error, us) {
        vector.selectAll(".counties")
            .data(topojson.feature(us, us.objects.counties).features)
          .enter().append("path")
            .attr("class", function(d) { return "q" + Math.floor(Math.random()*9) + "-9";})
            .attr("d", path);

        vector.append("path")
            .datum(topojson.mesh(us, us.objects.counties))
            .attr("d", path)
            .attr("class", "county-boundary");
      });

      function zoomed() {
        vector.attr("transform", "translate(" + d3.event.translate + ")scale(" + d3.event.scale + ")");
        vector.select(".state-border").style("stroke-width", 1.5 / d3.event.scale + "px");
        vector.select(".county-border").style("stroke-width", .5 / d3.event.scale + "px");

      }

    </script>
  </div>

  <div id='details'>

  </div>


</body>